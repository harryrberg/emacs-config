* Installing Emacs with Native Compilation via MSYS2 (MINGW64)

This guide explains how to install a full-featured Emacs build (GUI + native compilation support) on Windows using *MSYS2* in the *MINGW64* environment.

*Prerequisites:*
- Windows 10 or 11 (64-bit)
- Administrator access (recommended for editing the system PATH)

*Steps:*

1. Download and install *MSYS2* from the official site. Use a simple path like `C:\msys64` to avoid path length issues.
2. Open the *MSYS2 MINGW64* terminal (not MSYS or UCRT64) and update the system:
#+BEGIN_SRC bash
pacman -Syu
#+END_SRC
If prompted, restart the terminal and re-run the update until no further updates are available.
3. (Optional but recommended) Install the native Windows toolchain:
#+BEGIN_SRC bash
pacman -S --needed base-devel mingw-w64-x86_64-toolchain
#+END_SRC
4. Install Emacs with native compilation support:
#+BEGIN_SRC bash
pacman -S mingw-w64-x86_64-emacs mingw-w64-x86_64-libgccjit
#+END_SRC
This installs a prebuilt Emacs with GUI and `libgccjit` for native compilation.
5. Verify installation:
#+BEGIN_SRC powershell
emacs --version
#+END_SRC
Inside Emacs, check native compilation:
#+BEGIN_SRC elisp
(and (fboundp 'native-comp-available-p)
     (native-comp-available-p))
#+END_SRC
A non-nil result means native compilation is active.

*Why this method?*
- Prebuilt Emacs with native compilation — no manual build required.
- Includes `libgccjit` for faster performance.
- More stable than UCRT64 builds.

---
You now have a fast, fully-featured Emacs on Windows with reliable updates via MSYS2.

*Setting Environment Variables and Updating PATH*
These steps configure Emacs to recognize your home directory, specify the server file location for `emacsclient`, and allow Emacs to be run from PowerShell or CMD.

**Create the server directory (if missing)**
#+BEGIN_SRC powershell
$serverDir = Join-Path $env:USERPROFILE ".emacs.d\server"
New-Item -ItemType Directory -Path $serverDir -Force | Out-Null
#+END_SRC

**Set HOME (User scope)**
#+BEGIN_SRC powershell
[Environment]::SetEnvironmentVariable('HOME', $env:USERPROFILE, 'User')
#+END_SRC

**Set EMACS_SERVER_FILE (User scope)**
#+BEGIN_SRC powershell
$serverFile = Join-Path $env:USERPROFILE ".emacs.d\server\server"
[Environment]::SetEnvironmentVariable('EMACS_SERVER_FILE', $serverFile, 'User')
#+END_SRC

**Add MSYS2 MINGW64 bin to PATH (User scope)**
#+BEGIN_SRC powershell
$msysBin = "C:\\msys64\\mingw64\\bin"
$currentPath = [Environment]::GetEnvironmentVariable('Path', 'User')
if (-not $currentPath) { $currentPath = '' }
if ($currentPath -notmatch [regex]::Escape($msysBin)) {
    $newPath = if ($currentPath.Trim().Length -gt 0) {
        $currentPath.TrimEnd(';') + ';' + $msysBin
    } else {
        $msysBin
    }
    [Environment]::SetEnvironmentVariable('Path', $newPath, 'User')
}
Write-Output "User PATH updated. Restart terminals to apply changes."
#+END_SRC

After running these commands, restart PowerShell or CMD so the environment variables and PATH changes take effect.
---

* Configuring Emacs
Open `init.org` in Emacs, customize as you wish, and run `org-babel-tangle` to produce `init.el`. This extracts all Emacs Lisp code blocks into `init.el`. Restart Emacs to activate the changes.

* Preamble
Automatically regenerate `init.el` whenever you save `init.org`, ensuring your setup stays in sync.

** Auto-tangle init.org on save
This function checks if you’re editing `~/.emacs.d/init.org` and tangles it on save.

#+BEGIN_SRC emacs-lisp
(defun tangle-init-file ()
  (when (equal (buffer-file-name) (expand-file-name "~/.emacs.d/init.org"))
    (org-babel-tangle)))
(add-hook 'after-save-hook 'tangle-init-file)
#+END_SRC

* Performance Tweaks
Adjusting garbage collection thresholds can speed up startup and keep runtime smooth.

** Boost startup speed
Set GC threshold high during launch:

#+BEGIN_SRC emacs-lisp
(setq gc-cons-threshold most-positive-fixnum)
#+END_SRC

** Optimize runtime
Lower GC threshold after Emacs loads:

#+BEGIN_SRC emacs-lisp
(add-hook 'emacs-startup-hook (lambda () (setq gc-cons-threshold 16777216)))
#+END_SRC

* Package Management
We’ll configure `package.el` and `use-package` for flexible package handling.

#+BEGIN_SRC emacs-lisp
(require 'package)
(setq package-archives '(("melpa" . "https://melpa.org/packages/")
                         ("gnu" . "https://elpa.gnu.org/packages/")))
(package-initialize)
(unless package-archive-contents
  (package-refresh-contents))

(unless (package-installed-p 'org)
  (package-install 'org))

(unless (package-installed-p 'use-package)
  (package-install 'use-package))
(require 'use-package)
(setq use-package-always-ensure t)
#+END_SRC

* Appearance Settings
Customize Emacs visuals for a distraction-free, modern feel.

** Remove GUI clutter
Hide toolbar, scroll bar, and menu bar:

#+BEGIN_SRC emacs-lisp
(tool-bar-mode -1)
(scroll-bar-mode -1)
(menu-bar-mode -1)
#+END_SRC

** Hide startup screen
#+BEGIN_SRC emacs-lisp
(setq inhibit-startup-screen t)
#+END_SRC

** Empty scratch buffer message
#+BEGIN_SRC emacs-lisp
(setq initial-scratch-message nil)
#+END_SRC

** Set font
Default to JetBrains Mono, size 15:

#+BEGIN_SRC emacs-lisp
(defun my/set-frame-font ()
  (set-frame-font "JetBrains Mono-15" nil t))
(add-hook 'after-make-frame-functions
          (lambda (frame)
            (select-frame frame)
            (my/set-frame-font)))
(my/set-frame-font)
#+END_SRC

** Theme
Use the Modus Operandi theme with slanted and bold elements:

#+BEGIN_SRC emacs-lisp
(use-package modus-themes
  :ensure t
  :init
  (setq modus-themes-slanted-constructs t
        modus-themes-bold-constructs t)
  :config
  (load-theme 'modus-operandi :no-confirm))
#+END_SRC

* Environment Configuration
Fine-tune default paths and fullscreen behavior.

** Default working directory
#+BEGIN_SRC emacs-lisp
(cd "~")
#+END_SRC

** Fullscreen toggle
Function to toggle fullscreen:

#+BEGIN_SRC emacs-lisp
(defun toggle-fullscreen ()
  (interactive)
  (if (eq (frame-parameter nil 'fullscreen) 'fullboth)
      (set-frame-parameter nil 'fullscreen nil)
    (set-frame-parameter nil 'fullscreen 'fullboth)))
#+END_SRC

** Bind F11 for fullscreen
#+BEGIN_SRC emacs-lisp
(global-set-key [f11] 'toggle-fullscreen)
#+END_SRC

** Start fullscreen by default
#+BEGIN_SRC emacs-lisp
(add-to-list 'default-frame-alist '(fullscreen . fullboth))
#+END_SRC

** Fullscreen for daemon-created frames
#+BEGIN_SRC emacs-lisp
(defun set-fullscreen-for-new-frame (frame)
  (set-frame-parameter frame 'fullscreen 'fullboth))
(add-hook 'after-make-frame-functions #'set-fullscreen-for-new-frame)
#+END_SRC

* Org Mode Setup
Customize Org Mode for cleaner visuals and efficient task tracking.

** Basic Org settings
#+BEGIN_SRC emacs-lisp
(use-package org
  :config
  (setq org-hide-leading-stars t
        org-agenda-files '("~/org")
        org-todo-keywords '((sequence "TODO" "IN-PROGRESS" "WAITING" "DONE"))))
#+END_SRC

** Org Tempo for quick templates
#+BEGIN_SRC emacs-lisp
(require 'org-tempo)

(defun org-tempo-src-emacs-lisp-tangle-yes ()
  "Insert an emacs-lisp block with :tangle yes."
  (interactive)
  (let ((content (org-tempo--expand-structure-template '("se" . "src emacs-lisp :tangle yes"))))
    (insert content)
    (search-backward "#+END_SRC")))
(with-eval-after-load 'org-tempo
  (add-to-list 'org-structure-template-alist '("se" . "src emacs-lisp :tangle yes")))
#+END_SRC

* Org-ai Integration
Bring GPT-4 into Org Mode using `org-ai`.

** Usage
Place your API token in `~/.emacs.d/secret.el`:

#+BEGIN_SRC emacs-lisp
(setq my-openai-api-token "your_api_key_here")
#+END_SRC

** Configuration
#+BEGIN_SRC emacs-lisp
(use-package org-ai
  :ensure
  :commands (org-ai-mode)
  :init
  (load-file "~/.emacs.d/secret.el")
  :custom
  (org-ai-openai-api-token my-openai-api-token)
  :config
  (setq org-ai-default-chat-model "gpt-4")
  (org-ai-install-yasnippets))
#+END_SRC

* About
My personal Windows 10 Emacs configuration.
