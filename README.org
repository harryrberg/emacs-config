#+TITLE: Emacs Configuration for Windows 10
#+DESCRIPTION: A complete, tailored Emacs setup for Windows 10 users, focusing on speed, aesthetics, packages, environment tuning, Org mode, and ChatGPT integration.

* Installing Emacs on Windows 10 with Chocolatey
To install Emacs easily on Windows 10, we’ll use the Chocolatey package manager.

1. Open *Command Prompt* or *PowerShell* with administrator rights.  
2. Run this to install Chocolatey:

@"%SystemRoot%\System32\WindowsPowerShell\v1.0\powershell.exe" -NoProfile -InputFormat None -ExecutionPolicy Bypass -Command "iex ((New-Object System.Net.WebClient).DownloadString('https://chocolatey.org/install.ps1'))" && SET "PATH=%PATH%;%ALLUSERSPROFILE%\chocolatey\bin"

3. Install Emacs with:

choco install emacs

4. Confirm the installation worked:

emacs --version

* Setting Environment Variables
We’ll define some environment variables so Emacs knows where your home directory is and where the server file lives.

1. Right-click *This PC* (or *Computer*) and select *Properties*.  
2. Click *Advanced system settings* → *Environment Variables*.  
3. Under *User variables*, click *New*:  
   - Name: `HOME`  
   - Value: `%USERPROFILE%`  
4. Click *New* again:  
   - Name: `EMACS_SERVER_FILE`  
   - Value: `%USERPROFILE%\.emacs.d\server\server`  
5. Save and close all dialogs.

* Configuring Emacs
Open `init.org` in Emacs, customize as you wish, and run `org-babel-tangle` to produce `init.el`. This extracts all Emacs Lisp code blocks into `init.el`. Restart Emacs to activate the changes.

* Preamble
Automatically regenerate `init.el` whenever you save `init.org`, ensuring your setup stays in sync.

** Auto-tangle init.org on save
This function checks if you’re editing `~/.emacs.d/init.org` and tangles it on save.

#+BEGIN_SRC emacs-lisp
(defun tangle-init-file ()
  (when (equal (buffer-file-name) (expand-file-name "~/.emacs.d/init.org"))
    (org-babel-tangle)))
(add-hook 'after-save-hook 'tangle-init-file)
#+END_SRC

* Performance Tweaks
Adjusting garbage collection thresholds can speed up startup and keep runtime smooth.

** Boost startup speed
Set GC threshold high during launch:

#+BEGIN_SRC emacs-lisp
(setq gc-cons-threshold most-positive-fixnum)
#+END_SRC

** Optimize runtime
Lower GC threshold after Emacs loads:

#+BEGIN_SRC emacs-lisp
(add-hook 'emacs-startup-hook (lambda () (setq gc-cons-threshold 16777216)))
#+END_SRC

* Package Management
We’ll configure `package.el` and `use-package` for flexible package handling.

#+BEGIN_SRC emacs-lisp
(require 'package)
(setq package-archives '(("melpa" . "https://melpa.org/packages/")
                         ("gnu" . "https://elpa.gnu.org/packages/")))
(package-initialize)
(unless package-archive-contents
  (package-refresh-contents))

(unless (package-installed-p 'org)
  (package-install 'org))

(unless (package-installed-p 'use-package)
  (package-install 'use-package))
(require 'use-package)
(setq use-package-always-ensure t)
#+END_SRC

* Appearance Settings
Customize Emacs visuals for a distraction-free, modern feel.

** Remove GUI clutter
Hide toolbar, scroll bar, and menu bar:

#+BEGIN_SRC emacs-lisp
(tool-bar-mode -1)
(scroll-bar-mode -1)
(menu-bar-mode -1)
#+END_SRC

** Hide startup screen
#+BEGIN_SRC emacs-lisp
(setq inhibit-startup-screen t)
#+END_SRC

** Empty scratch buffer message
#+BEGIN_SRC emacs-lisp
(setq initial-scratch-message nil)
#+END_SRC

** Set font
Default to JetBrains Mono, size 15:

#+BEGIN_SRC emacs-lisp
(defun my/set-frame-font ()
  (set-frame-font "JetBrains Mono-15" nil t))
(add-hook 'after-make-frame-functions
          (lambda (frame)
            (select-frame frame)
            (my/set-frame-font)))
(my/set-frame-font)
#+END_SRC

** Theme
Use the Modus Operandi theme with slanted and bold elements:

#+BEGIN_SRC emacs-lisp
(use-package modus-themes
  :ensure t
  :init
  (setq modus-themes-slanted-constructs t
        modus-themes-bold-constructs t)
  :config
  (load-theme 'modus-operandi :no-confirm))
#+END_SRC

* Environment Configuration
Fine-tune default paths and fullscreen behavior.

** Default working directory
#+BEGIN_SRC emacs-lisp
(cd "~")
#+END_SRC

** Fullscreen toggle
Function to toggle fullscreen:

#+BEGIN_SRC emacs-lisp
(defun toggle-fullscreen ()
  (interactive)
  (if (eq (frame-parameter nil 'fullscreen) 'fullboth)
      (set-frame-parameter nil 'fullscreen nil)
    (set-frame-parameter nil 'fullscreen 'fullboth)))
#+END_SRC

** Bind F11 for fullscreen
#+BEGIN_SRC emacs-lisp
(global-set-key [f11] 'toggle-fullscreen)
#+END_SRC

** Start fullscreen by default
#+BEGIN_SRC emacs-lisp
(add-to-list 'default-frame-alist '(fullscreen . fullboth))
#+END_SRC

** Fullscreen for daemon-created frames
#+BEGIN_SRC emacs-lisp
(defun set-fullscreen-for-new-frame (frame)
  (set-frame-parameter frame 'fullscreen 'fullboth))
(add-hook 'after-make-frame-functions #'set-fullscreen-for-new-frame)
#+END_SRC

* Org Mode Setup
Customize Org Mode for cleaner visuals and efficient task tracking.

** Basic Org settings
#+BEGIN_SRC emacs-lisp
(use-package org
  :config
  (setq org-hide-leading-stars t
        org-agenda-files '("~/org")
        org-todo-keywords '((sequence "TODO" "IN-PROGRESS" "WAITING" "DONE"))))
#+END_SRC

** Org Tempo for quick templates
#+BEGIN_SRC emacs-lisp
(require 'org-tempo)

(defun org-tempo-src-emacs-lisp-tangle-yes ()
  "Insert an emacs-lisp block with :tangle yes."
  (interactive)
  (let ((content (org-tempo--expand-structure-template '("se" . "src emacs-lisp :tangle yes"))))
    (insert content)
    (search-backward "#+END_SRC")))
(with-eval-after-load 'org-tempo
  (add-to-list 'org-structure-template-alist '("se" . "src emacs-lisp :tangle yes")))
#+END_SRC

* Org-ai Integration
Bring GPT-4 into Org Mode using `org-ai`.

** Usage
Place your API token in `~/.emacs.d/secret.el`:

#+BEGIN_SRC emacs-lisp
(setq my-openai-api-token "your_api_key_here")
#+END_SRC

** Configuration
#+BEGIN_SRC emacs-lisp
(use-package org-ai
  :ensure
  :commands (org-ai-mode)
  :init
  (load-file "~/.emacs.d/secret.el")
  :custom
  (org-ai-openai-api-token my-openai-api-token)
  :config
  (setq org-ai-default-chat-model "gpt-4")
  (org-ai-install-yasnippets))
#+END_SRC

* About
My personal Windows 10 Emacs configuration.
